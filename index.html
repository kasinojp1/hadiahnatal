<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Natal Glow Reward</title>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

    body {
        margin: 0;
        font-family: 'Poppins', sans-serif;
        background: #0c0f12;
        color: #fff;
        overflow-x: hidden;
    }

    /* ‚ùÑ Animasi Salju */
    .snow {
        position: fixed;
        width: 100%;
        height: 100%;
        pointer-events: none;
        top: 0;
        left: 0;
        background-image:
            url('https://i.ibb.co/FXpbV3h/snow1.png'),
            url('https://i.ibb.co/FXpbV3h/snow2.png'),
            url('https://i.ibb.co/FXpbV3h/snow3.png');
        animation: snow 20s linear infinite;
    }
    @keyframes snow {
        0% { background-position: 0 0, 0 0, 0 0; }
        100% { background-position: 0 2000px, 0 1500px, 0 1000px; }
    }

    /* üéÑ Background Pohon Natal bergerak */
    .tree-bg {
        position: fixed;
        inset: 0;
        background: url("https://i.ibb.co/QpnSfGm/christmastree.png") center/contain no-repeat;
        opacity: 0.12;
        animation: floatTree 6s ease-in-out infinite alternate;
        pointer-events: none;
    }
    @keyframes floatTree {
        from { transform: translateY(-10px); }
        to { transform: translateY(10px); }
    }

    .container {
        position: relative;
        z-index: 5;
        padding: 25px;
        max-width: 450px;
        margin: auto;
        text-align: center;
    }

    h1 {
        font-size: 32px;
        color: #e8c65f;
        text-shadow: 0 0 12px rgba(255,230,140,0.9);
        margin-bottom: 10px;
    }

    .inputBox {
        background: rgba(255,255,255,0.07);
        padding: 15px;
        border-radius: 14px;
        border: 1px solid rgba(255,215,0,0.3);
        box-shadow: 0 0 12px rgba(255,215,0,0.2);
    }

    input {
        width: 100%;
        padding: 14px;
        border-radius: 10px;
        border: none;
        font-size: 16px;
        outline: none;
        margin-bottom: 10px;
        background: rgba(255,255,255,0.13);
        color: #fff;
    }

    button {
        width: 100%;
        padding: 14px;
        border-radius: 10px;
        border: none;
        background: linear-gradient(45deg,#d4af37,#ffef9f);
        color: #111;
        font-weight: 700;
        cursor: pointer;
        font-size: 16px;
        box-shadow: 0 0 15px rgba(255,215,0,0.5);
        transition: .2s;
    }
    button:active {
        transform: scale(.97);
    }

    /* üéÅ Kotak hadiah (hasil cek) */
    .hasilBox {
        margin-top: 20px;
        background: rgba(255,255,255,0.08);
        padding: 18px;
        border-radius: 14px;
        border: 1px solid rgba(255,215,0,0.3);
        box-shadow: 0 0 14px rgba(200,150,50,0.25);
        display: none;
    }

    .rewardItem {
        background: rgba(255,255,255,0.12);
        margin: 8px 0;
        padding: 12px;
        border-radius: 10px;
        border-left: 4px solid #d4af37;
        font-size: 17px;
        text-align: left;
    }
</style>
</head>
<body>

<div class="snow"></div>
<div class="tree-bg"></div>

<div class="container">
    <h1>üéÑ Natal Glow Reward</h1>

    <div class="inputBox">
        <input type="text" id="codeInput" placeholder="Masukkan Kode Hadiah">
        <button id="checkBtn">CEK HADIAH</button>
    </div>

    <div id="hasil" class="hasilBox"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDlpuf_uIlpmr2ybAqpJ2GTTRW-t86PGf0",
  authDomain: "hadiahnatal-a033b.firebaseapp.com",
  databaseURL: "https://hadiahnatal-a033b-default-rtdb.firebaseio.com",
  projectId: "hadiahnatal-a033b",
  storageBucket: "hadiahnatal-a033b.firebasestorage.app",
  messagingSenderId: "577153304596",
  appId: "1:577153304596:web:5f255e886a379ccb12bf01"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const input = document.getElementById("codeInput");
const btn = document.getElementById("checkBtn");
const hasil = document.getElementById("hasil");

btn.onclick = async () => {
    const code = input.value.trim();
    if(!code) return;

    const codeRef = ref(db, "history/" + code);
    const snap = await get(codeRef);

    if(!snap.exists()){
        hasil.style.display = "block";
        hasil.innerHTML = `<div class="rewardItem" style="border-left-color:#ff6b6b;">Kode tidak ditemukan</div>`;
        return;
    }

    const data = snap.val();

    // tampilkan hadiah
    hasil.style.display = "block";
    hasil.innerHTML = `
        <div class="rewardItem"><strong>Kode:</strong> ${code}</div>
        <div class="rewardItem"><strong>Hadiah:</strong> ${data.cards.join(", ")}</div>
        <div class="rewardItem"><strong>Waktu:</strong> ${new Date(data.time).toLocaleString()}</div>
        <div class="rewardItem"><strong>Status:</strong> ${data.used ? "Sudah digunakan ‚ùå" : "Belum digunakan ‚úî"}</div>
    `;

    // tandai sebagai used
    await update(codeRef,{ used:true });
};
</script>

</body>
</html>
